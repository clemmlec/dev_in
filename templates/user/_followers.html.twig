{% extends "user/profil.html.twig" %}

{% block title %}
    Abonnés | {{ parent()}}
{% endblock %}
{% block meta %} 
    <meta name="description" 
        content="Le site d'entraide entre developpeur, dans une idée de partage et de progression en toute solidarité ." 
    /> 
    <meta name="robots" 
        content="index,follow" 
    /> 
{% endblock %}
{% block mainProfil %}
    <hr>
    <h1>abonnés {{user.followers | length}}</h1>
    <div class="swip ">
        <div class="swiper mySwiper">
            <div class="swiper-wrapper">
                
                {% for follow in followers %}
                <div class="swiper-slide card" style="{{follow.user.style}}">
                    <h3 class="toptitre photo b-50 gris">
                        <img class="avatar" src="{{ follow.user.imageName ? vich_uploader_asset(follow.user, 'imageFile') : "https://fakeimg.pl/200x100" }}" alt="{{follow.user.name}}">
                    </h3>
                    <h1>{{follow.user.name}}
                        {% if app.user and app.user.id == user.id %}
                            <button type="button" class="btn-vierge yellow" value="{{follow.user.id}}" data-follow-user >
                                {% set fav = false %}
                                
                                {% for row in app.user.getFollows %}
                            
                                    {% if row.friend.id == follow.user.id %}
                                        {% set fav = true %}
                                    {% endif %}
                                {% endfor %}
                                {% if fav %}
                                    <i class="fa fa-user pointer yellow"></i>
                                {% else %}
                                    <i class="far fa-user pointer yellow"></i>
                                    
                                {% endif %}

                            </button>
                        {% endif %}
                    </h1>
                    <h3 class="date">inscrit {{follow.user.createdAt | ago}}</h3>
                    <h2>{{follow.user.followers | length}} followers</h2>
                    {% if follow.user.subjects %}
                        <h2>{{follow.user.subjects | length }} subjects postés</h2>
                        {% set moyenne = 0 %}
                        {% set nbVote = 0 %}
                        {% for row in follow.user.subjects %}
                            {% for note in row.noteSubjects %}
                                {% set moyenne = moyenne + note.note %}
                                {% set nbVote = nbVote +1 %}
                            {% endfor %}
                        {% endfor %}
                        {% if nbVote > 0 %}
                            {% set moyenne = moyenne / nbVote %}
                            <h2>Moyenne subjects {{ moyenne | round(2, 'floor') }}</h2>
                        {% endif %}
                    {% endif %}
                    <button class="btn-vierge"><a href="{{ path('app_user_profil', {'id': follow.user.id}) }}">voir le profil</a></button>
                    {# <a href="bb">dfgff sdg s sg </a> #}
                </div>
                {% endfor %}
                
            </div>
            <div class="swiper-pagination"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
        </div>
    </div>    

{% endblock %}

